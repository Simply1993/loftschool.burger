/* Hamburger menu */
let hamburger = (function (options) {
	let button = document.querySelector(options.button);
	let menu = document.querySelector(options.menu);
	let list = document.querySelector(".mobile-menu__list");

	let _openMenu = function (e) {
		e.preventDefault();
		menu.classList.toggle("active");
		document.body.classList.toggle("lock");
	};

	let closeMenu = function closeMenu(e) {
		e.preventDefault();
		if (e.target.className == "mobile-menu__link") {
			menu.classList.remove("active");
			document.body.classList.remove("lock");
		}
	};

	let addListeners = function () {
		button.addEventListener("click", _openMenu);

		list.addEventListener("click", closeMenu);
	};

	return {
		init: addListeners
	};
})({
	button: ".hamburger-menu-btn",
	menu: ".mobile-menu"
});

hamburger.init();

/* Vertical Accordeon */
// let verticalAccordeon = (function (options) {
// 	let list = document.querySelector(options.listSelector);
// 	let itemsList = list.querySelectorAll('.accordeon__item');
//
// 	let _getHeight = function _getHeight(elem) {
// 		let height = elem.scrollHeight + 'px';
// 		return height;
// 	};
//
// 	let _toogleItems = function (e) {
// 		e.preventDefault();
//
// 		if (e.target.className == options.linkClass) {
// 			let item = e.target.parentNode;
// 			let contentItem = item.querySelector('.accordeon__item-content');
//
// 			if (!item.classList.contains(options.activeItemClass)) {
// 				_closeItems(itemsList);
// 				_openItem(item, contentItem);
// 			} else {
// 				_closeItem(item, contentItem);
// 			}
// 		}
// 	};
//
// 	let _openItem = function _openItem(item, contentItem) {
// 		let contentHeight = _getHeight(contentItem);
//
// 		item.classList.toggle(options.activeItemClass);
// 		contentItem.style.height = contentHeight;
// 	};
//
// 	let _closeItem = function _closeItem(item, contentItem) {
// 		contentItem.style.height = '';
// 		item.classList.remove(options.activeItemClass);
// 	};
//
// 	let _closeItems = function _closeItems(items) {
// 		for (let i = 0; i < items.length; i++) {
// 			let contentItem = items[i].querySelector('.accordeon__item-content');
// 			_closeItem(items[i], contentItem);
// 		}
// 	};
//
// 	let addListeners = function () {
// 		list.addEventListener('click', _toogleItems)
// 	};
//
// 	return {
// 		init: addListeners
// 	}
// })({
// 	listSelector: ".accordeon__list",
// 	linkClass: "accordeon__trigger",
// 	activeItemClass: "accordeon__item--active",
// });
//
// verticalAccordeon.init();

/* Horizontal Accordeon */
// let horizontalAccordeon = (function (options) {
// 	let list = document.querySelector('.'+options.list);
// 	let itemsList = list.querySelectorAll('.'+options.item);
//
// 	/* calculate needed width */
// 	let userWidth = window.innerWidth;
// 	let titleItem = list.querySelector('.'+options.link);
// 	let widthTitle = titleItem.clientWidth;
// 	let neededWidth = userWidth - itemsList.length * widthTitle;
// 	console.log(neededWidth);
// 	neededWidth = (neededWidth > 520) ? 520 : neededWidth;
//
// 	let _toogleItems = function (e) {
// 		e.preventDefault();
//
// 		if (e.target.className == options.link) {
// 			let item = e.target.parentNode;
// 			let contentItem = item.querySelector('.'+options.content);
//
// 			if (!item.classList.contains(options.activeItem)) {
// 				_closeItems(itemsList);
// 				_openItem(item, contentItem);
// 			} else {
// 				_closeItem(item, contentItem);
// 			}
// 		}
// 	};
//
// 	let _openItem = function _openItem(item, contentItem) {
// 		item.classList.toggle(options.activeItem);
// 		contentItem.style.width = neededWidth + 'px';
// 	};
//
// 	let _closeItem = function _closeItem(item, contentItem) {
// 		contentItem.style.width = '';
// 		item.classList.remove(options.activeItem);
// 	};
//
// 	let _closeItems = function _closeItems(items) {
// 		for (let i = 0; i < items.length; i++) {
// 			let contentItem = items[i].querySelector('.'+options.content);
// 			_closeItem(items[i], contentItem);
// 		}
// 	};
//
// 	let addListeners = function () {
// 		list.addEventListener('click', _toogleItems)
// 	};
//
// 	return {
// 		init: addListeners
// 	}
// })({
// 	list: "menu-accordeon__list",
// 	item: "menu-accordeon__item",
// 	activeItem: "menu-accordeon__item--active",
// 	link: "menu-accordeon__trigger",
// 	content: "menu-accordeon__item-content"
// });
//
// horizontalAccordeon.init();

/* Multi-accordeon */
let multiAcco = function (options) {
	let list = document.querySelector('.'+options.list);
	let itemsList = list.querySelectorAll('.'+options.item);

	if (options.direction == "horizontal") {
		/* for calculate needed width */
		let userWidth = window.innerWidth;
		let titleItem = list.querySelector('.'+options.link);
		let widthTitle = titleItem.clientWidth;
		var neededWidth = userWidth - itemsList.length * widthTitle;
		neededWidth = (neededWidth > 520) ? '520px' : neededWidth + 'px';
	} else if (options.direction == "vertical") {
		/* for calculate needed height */
		var _getHeight = function(elem) {
			let height = elem.scrollHeight + 'px';
			return height;
		};
	}

	let _toogleItems = function (e) {
		e.preventDefault();

		if (e.target.className == options.link) {
			let item = e.target.parentNode;
			let contentItem = item.querySelector('.'+options.content);

			if (!item.classList.contains(options.activeItem)) {
				_closeItems(itemsList);
				_openItem(item, contentItem);
			} else {
				_closeItem(item, contentItem);
			}
		}
	};

	let _openItem = function(item, contentItem) {
		if (options.direction == "horizontal") {
			contentItem.style.width = neededWidth;
		} else if (options.direction == "vertical") {
			let contentHeight = _getHeight(contentItem);
			contentItem.style.height = contentHeight;
		}
		item.classList.toggle(options.activeItem);
	};

	let _closeItem = function(item, contentItem) {
		if (options.direction == "horizontal") {
			contentItem.style.width = '';
		} else if (options.direction == "vertical") {
			contentItem.style.height = '';
		}

		item.classList.remove(options.activeItem);
	};

	let _closeItems = function(items) {
		for (let i = 0; i < items.length; i++) {
			let contentItem = items[i].querySelector('.'+options.content);
			_closeItem(items[i], contentItem);
		}
	};

	let addListeners = function () {
		list.addEventListener('click', _toogleItems)
	};

	return {
		init: addListeners
	}
};

multiAcco({
	direction: "horizontal",
	list: "menu-accordeon__list",
	item: "menu-accordeon__item",
	activeItem: "menu-accordeon__item--active",
	link: "menu-accordeon__trigger",
	content: "menu-accordeon__item-content"
}).init();

multiAcco({
	direction: "vertical",
	list: "accordeon__list",
	item: "accordeon__item",
	activeItem: "accordeon__item--active",
	link: "accordeon__trigger",
	content: "accordeon__item-content"
}).init();

/* popup */
let popup  = function(options) {
	let wrapper = document.querySelector('.'+options.wrapper);

	let _tooglePopup = function (e) {
		e.preventDefault();

		if (e.target.className == options.btn) {
			let btn = e.target;

			_openPopup(btn);
		}
	};

	let _openPopup = function (btn) {
		let overlayElement = document.createElement('div');
		overlayElement.classList.add('overlay');

		let popupElement = document.createElement('div');
		popupElement.classList.add('popup');

		let contentElement = document.createElement('div');
		contentElement.classList.add('popup__content');

		let content = btn.parentNode;

		let text = content
			.querySelector('.'+options.text)
			.textContent;
		contentElement.innerHTML = text;

		let titleElement = document.createElement('div');
		titleElement.classList.add('popup__title');

		let title = content
			.querySelector('.'+options.title)
			.textContent;
		titleElement.innerHTML = title;

		let closeElement = document.createElement("a");
		closeElement.classList.add("popup__close");
		closeElement.innerHTML = '<svg class="dropdown__close-picture"><use xlink:href="./img/icons/mysprite.svg#close"></use></svg>';
		closeElement.href = "#";
		closeElement.addEventListener("click", function(e) {
			e.preventDefault();
			_closePopup(overlayElement);
		});

		overlayElement.appendChild(popupElement);
		popupElement.appendChild(titleElement);
		popupElement.appendChild(contentElement);
		popupElement.appendChild(closeElement);

		document.body.appendChild(overlayElement);
	};

	let _closePopup = function (overlay) {
		document.body.removeChild(overlay);
	};

	let addListeners = function () {
		wrapper.addEventListener('click', _tooglePopup)
	};

	return {
		init: addListeners
	}
};

popup({
	wrapper: "reviews__list",
	btn: "reviews__button",
	title: "reviews__title",
	text: "reviews__text"
}).init();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIEhhbWJ1cmdlciBtZW51ICovXG5sZXQgaGFtYnVyZ2VyID0gKGZ1bmN0aW9uIChvcHRpb25zKSB7XG5cdGxldCBidXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG9wdGlvbnMuYnV0dG9uKTtcblx0bGV0IG1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG9wdGlvbnMubWVudSk7XG5cdGxldCBsaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2JpbGUtbWVudV9fbGlzdFwiKTtcblxuXHRsZXQgX29wZW5NZW51ID0gZnVuY3Rpb24gKGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0bWVudS5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZlXCIpO1xuXHRcdGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnRvZ2dsZShcImxvY2tcIik7XG5cdH07XG5cblx0bGV0IGNsb3NlTWVudSA9IGZ1bmN0aW9uIGNsb3NlTWVudShlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdGlmIChlLnRhcmdldC5jbGFzc05hbWUgPT0gXCJtb2JpbGUtbWVudV9fbGlua1wiKSB7XG5cdFx0XHRtZW51LmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIik7XG5cdFx0XHRkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoXCJsb2NrXCIpO1xuXHRcdH1cblx0fTtcblxuXHRsZXQgYWRkTGlzdGVuZXJzID0gZnVuY3Rpb24gKCkge1xuXHRcdGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgX29wZW5NZW51KTtcblxuXHRcdGxpc3QuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNsb3NlTWVudSk7XG5cdH07XG5cblx0cmV0dXJuIHtcblx0XHRpbml0OiBhZGRMaXN0ZW5lcnNcblx0fTtcbn0pKHtcblx0YnV0dG9uOiBcIi5oYW1idXJnZXItbWVudS1idG5cIixcblx0bWVudTogXCIubW9iaWxlLW1lbnVcIlxufSk7XG5cbmhhbWJ1cmdlci5pbml0KCk7XG5cbi8qIFZlcnRpY2FsIEFjY29yZGVvbiAqL1xuLy8gbGV0IHZlcnRpY2FsQWNjb3JkZW9uID0gKGZ1bmN0aW9uIChvcHRpb25zKSB7XG4vLyBcdGxldCBsaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihvcHRpb25zLmxpc3RTZWxlY3Rvcik7XG4vLyBcdGxldCBpdGVtc0xpc3QgPSBsaXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJy5hY2NvcmRlb25fX2l0ZW0nKTtcbi8vXG4vLyBcdGxldCBfZ2V0SGVpZ2h0ID0gZnVuY3Rpb24gX2dldEhlaWdodChlbGVtKSB7XG4vLyBcdFx0bGV0IGhlaWdodCA9IGVsZW0uc2Nyb2xsSGVpZ2h0ICsgJ3B4Jztcbi8vIFx0XHRyZXR1cm4gaGVpZ2h0O1xuLy8gXHR9O1xuLy9cbi8vIFx0bGV0IF90b29nbGVJdGVtcyA9IGZ1bmN0aW9uIChlKSB7XG4vLyBcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuLy9cbi8vIFx0XHRpZiAoZS50YXJnZXQuY2xhc3NOYW1lID09IG9wdGlvbnMubGlua0NsYXNzKSB7XG4vLyBcdFx0XHRsZXQgaXRlbSA9IGUudGFyZ2V0LnBhcmVudE5vZGU7XG4vLyBcdFx0XHRsZXQgY29udGVudEl0ZW0gPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoJy5hY2NvcmRlb25fX2l0ZW0tY29udGVudCcpO1xuLy9cbi8vIFx0XHRcdGlmICghaXRlbS5jbGFzc0xpc3QuY29udGFpbnMob3B0aW9ucy5hY3RpdmVJdGVtQ2xhc3MpKSB7XG4vLyBcdFx0XHRcdF9jbG9zZUl0ZW1zKGl0ZW1zTGlzdCk7XG4vLyBcdFx0XHRcdF9vcGVuSXRlbShpdGVtLCBjb250ZW50SXRlbSk7XG4vLyBcdFx0XHR9IGVsc2Uge1xuLy8gXHRcdFx0XHRfY2xvc2VJdGVtKGl0ZW0sIGNvbnRlbnRJdGVtKTtcbi8vIFx0XHRcdH1cbi8vIFx0XHR9XG4vLyBcdH07XG4vL1xuLy8gXHRsZXQgX29wZW5JdGVtID0gZnVuY3Rpb24gX29wZW5JdGVtKGl0ZW0sIGNvbnRlbnRJdGVtKSB7XG4vLyBcdFx0bGV0IGNvbnRlbnRIZWlnaHQgPSBfZ2V0SGVpZ2h0KGNvbnRlbnRJdGVtKTtcbi8vXG4vLyBcdFx0aXRlbS5jbGFzc0xpc3QudG9nZ2xlKG9wdGlvbnMuYWN0aXZlSXRlbUNsYXNzKTtcbi8vIFx0XHRjb250ZW50SXRlbS5zdHlsZS5oZWlnaHQgPSBjb250ZW50SGVpZ2h0O1xuLy8gXHR9O1xuLy9cbi8vIFx0bGV0IF9jbG9zZUl0ZW0gPSBmdW5jdGlvbiBfY2xvc2VJdGVtKGl0ZW0sIGNvbnRlbnRJdGVtKSB7XG4vLyBcdFx0Y29udGVudEl0ZW0uc3R5bGUuaGVpZ2h0ID0gJyc7XG4vLyBcdFx0aXRlbS5jbGFzc0xpc3QucmVtb3ZlKG9wdGlvbnMuYWN0aXZlSXRlbUNsYXNzKTtcbi8vIFx0fTtcbi8vXG4vLyBcdGxldCBfY2xvc2VJdGVtcyA9IGZ1bmN0aW9uIF9jbG9zZUl0ZW1zKGl0ZW1zKSB7XG4vLyBcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuLy8gXHRcdFx0bGV0IGNvbnRlbnRJdGVtID0gaXRlbXNbaV0ucXVlcnlTZWxlY3RvcignLmFjY29yZGVvbl9faXRlbS1jb250ZW50Jyk7XG4vLyBcdFx0XHRfY2xvc2VJdGVtKGl0ZW1zW2ldLCBjb250ZW50SXRlbSk7XG4vLyBcdFx0fVxuLy8gXHR9O1xuLy9cbi8vIFx0bGV0IGFkZExpc3RlbmVycyA9IGZ1bmN0aW9uICgpIHtcbi8vIFx0XHRsaXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgX3Rvb2dsZUl0ZW1zKVxuLy8gXHR9O1xuLy9cbi8vIFx0cmV0dXJuIHtcbi8vIFx0XHRpbml0OiBhZGRMaXN0ZW5lcnNcbi8vIFx0fVxuLy8gfSkoe1xuLy8gXHRsaXN0U2VsZWN0b3I6IFwiLmFjY29yZGVvbl9fbGlzdFwiLFxuLy8gXHRsaW5rQ2xhc3M6IFwiYWNjb3JkZW9uX190cmlnZ2VyXCIsXG4vLyBcdGFjdGl2ZUl0ZW1DbGFzczogXCJhY2NvcmRlb25fX2l0ZW0tLWFjdGl2ZVwiLFxuLy8gfSk7XG4vL1xuLy8gdmVydGljYWxBY2NvcmRlb24uaW5pdCgpO1xuXG4vKiBIb3Jpem9udGFsIEFjY29yZGVvbiAqL1xuLy8gbGV0IGhvcml6b250YWxBY2NvcmRlb24gPSAoZnVuY3Rpb24gKG9wdGlvbnMpIHtcbi8vIFx0bGV0IGxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuJytvcHRpb25zLmxpc3QpO1xuLy8gXHRsZXQgaXRlbXNMaXN0ID0gbGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcuJytvcHRpb25zLml0ZW0pO1xuLy9cbi8vIFx0LyogY2FsY3VsYXRlIG5lZWRlZCB3aWR0aCAqL1xuLy8gXHRsZXQgdXNlcldpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG4vLyBcdGxldCB0aXRsZUl0ZW0gPSBsaXN0LnF1ZXJ5U2VsZWN0b3IoJy4nK29wdGlvbnMubGluayk7XG4vLyBcdGxldCB3aWR0aFRpdGxlID0gdGl0bGVJdGVtLmNsaWVudFdpZHRoO1xuLy8gXHRsZXQgbmVlZGVkV2lkdGggPSB1c2VyV2lkdGggLSBpdGVtc0xpc3QubGVuZ3RoICogd2lkdGhUaXRsZTtcbi8vIFx0Y29uc29sZS5sb2cobmVlZGVkV2lkdGgpO1xuLy8gXHRuZWVkZWRXaWR0aCA9IChuZWVkZWRXaWR0aCA+IDUyMCkgPyA1MjAgOiBuZWVkZWRXaWR0aDtcbi8vXG4vLyBcdGxldCBfdG9vZ2xlSXRlbXMgPSBmdW5jdGlvbiAoZSkge1xuLy8gXHRcdGUucHJldmVudERlZmF1bHQoKTtcbi8vXG4vLyBcdFx0aWYgKGUudGFyZ2V0LmNsYXNzTmFtZSA9PSBvcHRpb25zLmxpbmspIHtcbi8vIFx0XHRcdGxldCBpdGVtID0gZS50YXJnZXQucGFyZW50Tm9kZTtcbi8vIFx0XHRcdGxldCBjb250ZW50SXRlbSA9IGl0ZW0ucXVlcnlTZWxlY3RvcignLicrb3B0aW9ucy5jb250ZW50KTtcbi8vXG4vLyBcdFx0XHRpZiAoIWl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKG9wdGlvbnMuYWN0aXZlSXRlbSkpIHtcbi8vIFx0XHRcdFx0X2Nsb3NlSXRlbXMoaXRlbXNMaXN0KTtcbi8vIFx0XHRcdFx0X29wZW5JdGVtKGl0ZW0sIGNvbnRlbnRJdGVtKTtcbi8vIFx0XHRcdH0gZWxzZSB7XG4vLyBcdFx0XHRcdF9jbG9zZUl0ZW0oaXRlbSwgY29udGVudEl0ZW0pO1xuLy8gXHRcdFx0fVxuLy8gXHRcdH1cbi8vIFx0fTtcbi8vXG4vLyBcdGxldCBfb3Blbkl0ZW0gPSBmdW5jdGlvbiBfb3Blbkl0ZW0oaXRlbSwgY29udGVudEl0ZW0pIHtcbi8vIFx0XHRpdGVtLmNsYXNzTGlzdC50b2dnbGUob3B0aW9ucy5hY3RpdmVJdGVtKTtcbi8vIFx0XHRjb250ZW50SXRlbS5zdHlsZS53aWR0aCA9IG5lZWRlZFdpZHRoICsgJ3B4Jztcbi8vIFx0fTtcbi8vXG4vLyBcdGxldCBfY2xvc2VJdGVtID0gZnVuY3Rpb24gX2Nsb3NlSXRlbShpdGVtLCBjb250ZW50SXRlbSkge1xuLy8gXHRcdGNvbnRlbnRJdGVtLnN0eWxlLndpZHRoID0gJyc7XG4vLyBcdFx0aXRlbS5jbGFzc0xpc3QucmVtb3ZlKG9wdGlvbnMuYWN0aXZlSXRlbSk7XG4vLyBcdH07XG4vL1xuLy8gXHRsZXQgX2Nsb3NlSXRlbXMgPSBmdW5jdGlvbiBfY2xvc2VJdGVtcyhpdGVtcykge1xuLy8gXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcbi8vIFx0XHRcdGxldCBjb250ZW50SXRlbSA9IGl0ZW1zW2ldLnF1ZXJ5U2VsZWN0b3IoJy4nK29wdGlvbnMuY29udGVudCk7XG4vLyBcdFx0XHRfY2xvc2VJdGVtKGl0ZW1zW2ldLCBjb250ZW50SXRlbSk7XG4vLyBcdFx0fVxuLy8gXHR9O1xuLy9cbi8vIFx0bGV0IGFkZExpc3RlbmVycyA9IGZ1bmN0aW9uICgpIHtcbi8vIFx0XHRsaXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgX3Rvb2dsZUl0ZW1zKVxuLy8gXHR9O1xuLy9cbi8vIFx0cmV0dXJuIHtcbi8vIFx0XHRpbml0OiBhZGRMaXN0ZW5lcnNcbi8vIFx0fVxuLy8gfSkoe1xuLy8gXHRsaXN0OiBcIm1lbnUtYWNjb3JkZW9uX19saXN0XCIsXG4vLyBcdGl0ZW06IFwibWVudS1hY2NvcmRlb25fX2l0ZW1cIixcbi8vIFx0YWN0aXZlSXRlbTogXCJtZW51LWFjY29yZGVvbl9faXRlbS0tYWN0aXZlXCIsXG4vLyBcdGxpbms6IFwibWVudS1hY2NvcmRlb25fX3RyaWdnZXJcIixcbi8vIFx0Y29udGVudDogXCJtZW51LWFjY29yZGVvbl9faXRlbS1jb250ZW50XCJcbi8vIH0pO1xuLy9cbi8vIGhvcml6b250YWxBY2NvcmRlb24uaW5pdCgpO1xuXG4vKiBNdWx0aS1hY2NvcmRlb24gKi9cbmxldCBtdWx0aUFjY28gPSBmdW5jdGlvbiAob3B0aW9ucykge1xuXHRsZXQgbGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nK29wdGlvbnMubGlzdCk7XG5cdGxldCBpdGVtc0xpc3QgPSBsaXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJy4nK29wdGlvbnMuaXRlbSk7XG5cblx0aWYgKG9wdGlvbnMuZGlyZWN0aW9uID09IFwiaG9yaXpvbnRhbFwiKSB7XG5cdFx0LyogZm9yIGNhbGN1bGF0ZSBuZWVkZWQgd2lkdGggKi9cblx0XHRsZXQgdXNlcldpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG5cdFx0bGV0IHRpdGxlSXRlbSA9IGxpc3QucXVlcnlTZWxlY3RvcignLicrb3B0aW9ucy5saW5rKTtcblx0XHRsZXQgd2lkdGhUaXRsZSA9IHRpdGxlSXRlbS5jbGllbnRXaWR0aDtcblx0XHR2YXIgbmVlZGVkV2lkdGggPSB1c2VyV2lkdGggLSBpdGVtc0xpc3QubGVuZ3RoICogd2lkdGhUaXRsZTtcblx0XHRuZWVkZWRXaWR0aCA9IChuZWVkZWRXaWR0aCA+IDUyMCkgPyAnNTIwcHgnIDogbmVlZGVkV2lkdGggKyAncHgnO1xuXHR9IGVsc2UgaWYgKG9wdGlvbnMuZGlyZWN0aW9uID09IFwidmVydGljYWxcIikge1xuXHRcdC8qIGZvciBjYWxjdWxhdGUgbmVlZGVkIGhlaWdodCAqL1xuXHRcdHZhciBfZ2V0SGVpZ2h0ID0gZnVuY3Rpb24oZWxlbSkge1xuXHRcdFx0bGV0IGhlaWdodCA9IGVsZW0uc2Nyb2xsSGVpZ2h0ICsgJ3B4Jztcblx0XHRcdHJldHVybiBoZWlnaHQ7XG5cdFx0fTtcblx0fVxuXG5cdGxldCBfdG9vZ2xlSXRlbXMgPSBmdW5jdGlvbiAoZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdGlmIChlLnRhcmdldC5jbGFzc05hbWUgPT0gb3B0aW9ucy5saW5rKSB7XG5cdFx0XHRsZXQgaXRlbSA9IGUudGFyZ2V0LnBhcmVudE5vZGU7XG5cdFx0XHRsZXQgY29udGVudEl0ZW0gPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoJy4nK29wdGlvbnMuY29udGVudCk7XG5cblx0XHRcdGlmICghaXRlbS5jbGFzc0xpc3QuY29udGFpbnMob3B0aW9ucy5hY3RpdmVJdGVtKSkge1xuXHRcdFx0XHRfY2xvc2VJdGVtcyhpdGVtc0xpc3QpO1xuXHRcdFx0XHRfb3Blbkl0ZW0oaXRlbSwgY29udGVudEl0ZW0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0X2Nsb3NlSXRlbShpdGVtLCBjb250ZW50SXRlbSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xuXG5cdGxldCBfb3Blbkl0ZW0gPSBmdW5jdGlvbihpdGVtLCBjb250ZW50SXRlbSkge1xuXHRcdGlmIChvcHRpb25zLmRpcmVjdGlvbiA9PSBcImhvcml6b250YWxcIikge1xuXHRcdFx0Y29udGVudEl0ZW0uc3R5bGUud2lkdGggPSBuZWVkZWRXaWR0aDtcblx0XHR9IGVsc2UgaWYgKG9wdGlvbnMuZGlyZWN0aW9uID09IFwidmVydGljYWxcIikge1xuXHRcdFx0bGV0IGNvbnRlbnRIZWlnaHQgPSBfZ2V0SGVpZ2h0KGNvbnRlbnRJdGVtKTtcblx0XHRcdGNvbnRlbnRJdGVtLnN0eWxlLmhlaWdodCA9IGNvbnRlbnRIZWlnaHQ7XG5cdFx0fVxuXHRcdGl0ZW0uY2xhc3NMaXN0LnRvZ2dsZShvcHRpb25zLmFjdGl2ZUl0ZW0pO1xuXHR9O1xuXG5cdGxldCBfY2xvc2VJdGVtID0gZnVuY3Rpb24oaXRlbSwgY29udGVudEl0ZW0pIHtcblx0XHRpZiAob3B0aW9ucy5kaXJlY3Rpb24gPT0gXCJob3Jpem9udGFsXCIpIHtcblx0XHRcdGNvbnRlbnRJdGVtLnN0eWxlLndpZHRoID0gJyc7XG5cdFx0fSBlbHNlIGlmIChvcHRpb25zLmRpcmVjdGlvbiA9PSBcInZlcnRpY2FsXCIpIHtcblx0XHRcdGNvbnRlbnRJdGVtLnN0eWxlLmhlaWdodCA9ICcnO1xuXHRcdH1cblxuXHRcdGl0ZW0uY2xhc3NMaXN0LnJlbW92ZShvcHRpb25zLmFjdGl2ZUl0ZW0pO1xuXHR9O1xuXG5cdGxldCBfY2xvc2VJdGVtcyA9IGZ1bmN0aW9uKGl0ZW1zKSB7XG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0bGV0IGNvbnRlbnRJdGVtID0gaXRlbXNbaV0ucXVlcnlTZWxlY3RvcignLicrb3B0aW9ucy5jb250ZW50KTtcblx0XHRcdF9jbG9zZUl0ZW0oaXRlbXNbaV0sIGNvbnRlbnRJdGVtKTtcblx0XHR9XG5cdH07XG5cblx0bGV0IGFkZExpc3RlbmVycyA9IGZ1bmN0aW9uICgpIHtcblx0XHRsaXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgX3Rvb2dsZUl0ZW1zKVxuXHR9O1xuXG5cdHJldHVybiB7XG5cdFx0aW5pdDogYWRkTGlzdGVuZXJzXG5cdH1cbn07XG5cbm11bHRpQWNjbyh7XG5cdGRpcmVjdGlvbjogXCJob3Jpem9udGFsXCIsXG5cdGxpc3Q6IFwibWVudS1hY2NvcmRlb25fX2xpc3RcIixcblx0aXRlbTogXCJtZW51LWFjY29yZGVvbl9faXRlbVwiLFxuXHRhY3RpdmVJdGVtOiBcIm1lbnUtYWNjb3JkZW9uX19pdGVtLS1hY3RpdmVcIixcblx0bGluazogXCJtZW51LWFjY29yZGVvbl9fdHJpZ2dlclwiLFxuXHRjb250ZW50OiBcIm1lbnUtYWNjb3JkZW9uX19pdGVtLWNvbnRlbnRcIlxufSkuaW5pdCgpO1xuXG5tdWx0aUFjY28oe1xuXHRkaXJlY3Rpb246IFwidmVydGljYWxcIixcblx0bGlzdDogXCJhY2NvcmRlb25fX2xpc3RcIixcblx0aXRlbTogXCJhY2NvcmRlb25fX2l0ZW1cIixcblx0YWN0aXZlSXRlbTogXCJhY2NvcmRlb25fX2l0ZW0tLWFjdGl2ZVwiLFxuXHRsaW5rOiBcImFjY29yZGVvbl9fdHJpZ2dlclwiLFxuXHRjb250ZW50OiBcImFjY29yZGVvbl9faXRlbS1jb250ZW50XCJcbn0pLmluaXQoKTtcblxuLyogcG9wdXAgKi9cbmxldCBwb3B1cCAgPSBmdW5jdGlvbihvcHRpb25zKSB7XG5cdGxldCB3cmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicrb3B0aW9ucy53cmFwcGVyKTtcblxuXHRsZXQgX3Rvb2dsZVBvcHVwID0gZnVuY3Rpb24gKGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRpZiAoZS50YXJnZXQuY2xhc3NOYW1lID09IG9wdGlvbnMuYnRuKSB7XG5cdFx0XHRsZXQgYnRuID0gZS50YXJnZXQ7XG5cblx0XHRcdF9vcGVuUG9wdXAoYnRuKTtcblx0XHR9XG5cdH07XG5cblx0bGV0IF9vcGVuUG9wdXAgPSBmdW5jdGlvbiAoYnRuKSB7XG5cdFx0bGV0IG92ZXJsYXlFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0b3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnb3ZlcmxheScpO1xuXG5cdFx0bGV0IHBvcHVwRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdHBvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdwb3B1cCcpO1xuXG5cdFx0bGV0IGNvbnRlbnRFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0Y29udGVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgncG9wdXBfX2NvbnRlbnQnKTtcblxuXHRcdGxldCBjb250ZW50ID0gYnRuLnBhcmVudE5vZGU7XG5cblx0XHRsZXQgdGV4dCA9IGNvbnRlbnRcblx0XHRcdC5xdWVyeVNlbGVjdG9yKCcuJytvcHRpb25zLnRleHQpXG5cdFx0XHQudGV4dENvbnRlbnQ7XG5cdFx0Y29udGVudEVsZW1lbnQuaW5uZXJIVE1MID0gdGV4dDtcblxuXHRcdGxldCB0aXRsZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHR0aXRsZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgncG9wdXBfX3RpdGxlJyk7XG5cblx0XHRsZXQgdGl0bGUgPSBjb250ZW50XG5cdFx0XHQucXVlcnlTZWxlY3RvcignLicrb3B0aW9ucy50aXRsZSlcblx0XHRcdC50ZXh0Q29udGVudDtcblx0XHR0aXRsZUVsZW1lbnQuaW5uZXJIVE1MID0gdGl0bGU7XG5cblx0XHRsZXQgY2xvc2VFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIik7XG5cdFx0Y2xvc2VFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9fY2xvc2VcIik7XG5cdFx0Y2xvc2VFbGVtZW50LmlubmVySFRNTCA9ICc8c3ZnIGNsYXNzPVwiZHJvcGRvd25fX2Nsb3NlLXBpY3R1cmVcIj48dXNlIHhsaW5rOmhyZWY9XCIuL2ltZy9pY29ucy9teXNwcml0ZS5zdmcjY2xvc2VcIj48L3VzZT48L3N2Zz4nO1xuXHRcdGNsb3NlRWxlbWVudC5ocmVmID0gXCIjXCI7XG5cdFx0Y2xvc2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRfY2xvc2VQb3B1cChvdmVybGF5RWxlbWVudCk7XG5cdFx0fSk7XG5cblx0XHRvdmVybGF5RWxlbWVudC5hcHBlbmRDaGlsZChwb3B1cEVsZW1lbnQpO1xuXHRcdHBvcHVwRWxlbWVudC5hcHBlbmRDaGlsZCh0aXRsZUVsZW1lbnQpO1xuXHRcdHBvcHVwRWxlbWVudC5hcHBlbmRDaGlsZChjb250ZW50RWxlbWVudCk7XG5cdFx0cG9wdXBFbGVtZW50LmFwcGVuZENoaWxkKGNsb3NlRWxlbWVudCk7XG5cblx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG92ZXJsYXlFbGVtZW50KTtcblx0fTtcblxuXHRsZXQgX2Nsb3NlUG9wdXAgPSBmdW5jdGlvbiAob3ZlcmxheSkge1xuXHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQob3ZlcmxheSk7XG5cdH07XG5cblx0bGV0IGFkZExpc3RlbmVycyA9IGZ1bmN0aW9uICgpIHtcblx0XHR3cmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgX3Rvb2dsZVBvcHVwKVxuXHR9O1xuXG5cdHJldHVybiB7XG5cdFx0aW5pdDogYWRkTGlzdGVuZXJzXG5cdH1cbn07XG5cbnBvcHVwKHtcblx0d3JhcHBlcjogXCJyZXZpZXdzX19saXN0XCIsXG5cdGJ0bjogXCJyZXZpZXdzX19idXR0b25cIixcblx0dGl0bGU6IFwicmV2aWV3c19fdGl0bGVcIixcblx0dGV4dDogXCJyZXZpZXdzX190ZXh0XCJcbn0pLmluaXQoKTsiXX0=
